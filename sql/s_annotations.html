<!doctype HTML>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="codemirror.js"></script>
<script src="runmode.js"></script>
<script src="pyret.js"></script>
<script src="hilite.js"></script>
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>2.1.10&nbsp;Annotations</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="codemirror.css" title="default"/><link rel="stylesheet" type="text/css" href="pyret.css" title="default"/><link rel="stylesheet" type="text/css" href="styles.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Pyret</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Getting_Started.html" class="tocviewlink" data-pltdoc="x">Getting Started</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Language_Concepts.html" class="tocviewselflink" data-pltdoc="x">Language Concepts</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Builtins_and_Libraries.html" class="tocviewlink" data-pltdoc="x">Builtins and Libraries</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Internals.html" class="tocviewlink" data-pltdoc="x">Internals</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>2&nbsp;</td><td><a href="Language_Concepts.html" class="tocviewlink" data-pltdoc="x">Language Concepts</a></td></tr></table><div class="tocviewsublist" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">2.1&nbsp;</td><td><a href="s_forms.html" class="tocviewselflink" data-pltdoc="x">Language Constructs</a></td></tr><tr><td align="right">2.2&nbsp;</td><td><a href="testing.html" class="tocviewlink" data-pltdoc="x">Testing</a></td></tr><tr><td align="right">2.3&nbsp;</td><td><a href="equality.html" class="tocviewlink" data-pltdoc="x">equality</a></td></tr><tr><td align="right">2.4&nbsp;</td><td><a href="brands.html" class="tocviewlink" data-pltdoc="x">Brands</a></td></tr><tr><td align="right">2.5&nbsp;</td><td><a href="type-check.html" class="tocviewlink" data-pltdoc="x">Type Checking</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9660;</a></td><td>2.1&nbsp;</td><td><a href="s_forms.html" class="tocviewlink" data-pltdoc="x">Language Constructs</a></td></tr></table><div class="tocviewsublist" style="display: block;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right">2.1.1&nbsp;</td><td><a href="s_literals.html" class="tocviewlink" data-pltdoc="x">Primitives and Literals</a></td></tr><tr><td align="right">2.1.2&nbsp;</td><td><a href="s_program.html" class="tocviewlink" data-pltdoc="x">Programs</a></td></tr><tr><td align="right">2.1.3&nbsp;</td><td><a href="Import_Statements.html" class="tocviewlink" data-pltdoc="x">Import Statements</a></td></tr><tr><td align="right">2.1.4&nbsp;</td><td><a href="Provide_Statements.html" class="tocviewlink" data-pltdoc="x">Provide Statements</a></td></tr><tr><td align="right">2.1.5&nbsp;</td><td><a href="Bindings.html" class="tocviewlink" data-pltdoc="x">Bindings</a></td></tr><tr><td align="right">2.1.6&nbsp;</td><td><a href="Blocks.html" class="tocviewlink" data-pltdoc="x">Blocks</a></td></tr><tr><td align="right">2.1.7&nbsp;</td><td><a href="Declarations.html" class="tocviewlink" data-pltdoc="x">Declarations</a></td></tr><tr><td align="right">2.1.8&nbsp;</td><td><a href="Statements.html" class="tocviewlink" data-pltdoc="x">Statements</a></td></tr><tr><td align="right">2.1.9&nbsp;</td><td><a href="Expressions.html" class="tocviewlink" data-pltdoc="x">Expressions</a></td></tr><tr><td align="right">2.1.10&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Annotations</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_3&quot;);">&#9658;</a></td><td>2.1.10&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Annotations</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_3"><table cellspacing="0" cellpadding="0"><tr><td align="right">2.1.10.1&nbsp;</td><td><a href="#%28part._s~3aname-ann%29" class="tocviewlink" data-pltdoc="x">Name Annotations</a></td></tr><tr><td align="right">2.1.10.2&nbsp;</td><td><a href="#%28part._s~3aapp-ann%29" class="tocviewlink" data-pltdoc="x">Parametric Annotations</a></td></tr><tr><td align="right">2.1.10.3&nbsp;</td><td><a href="#%28part._s~3aarrow-ann%29" class="tocviewlink" data-pltdoc="x">Arrow Annotations</a></td></tr><tr><td align="right">2.1.10.4&nbsp;</td><td><a href="#%28part._s~3apred-ann%29" class="tocviewlink" data-pltdoc="x">Predicate Annotations</a></td></tr><tr><td align="right">2.1.10.5&nbsp;</td><td><a href="#%28part._s~3atuple-ann%29" class="tocviewlink" data-pltdoc="x">Tuple Annotations</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">2.1.10.1<tt>&nbsp;</tt></span><a href="#%28part._s~3aname-ann%29" class="tocsubseclink" data-pltdoc="x">Name Annotations</a></td></tr><tr><td><span class="tocsublinknumber">2.1.10.2<tt>&nbsp;</tt></span><a href="#%28part._s~3aapp-ann%29" class="tocsubseclink" data-pltdoc="x">Parametric Annotations</a></td></tr><tr><td><span class="tocsublinknumber">2.1.10.3<tt>&nbsp;</tt></span><a href="#%28part._s~3aarrow-ann%29" class="tocsubseclink" data-pltdoc="x">Arrow Annotations</a></td></tr><tr><td><span class="tocsublinknumber">2.1.10.4<tt>&nbsp;</tt></span><a href="#%28part._s~3apred-ann%29" class="tocsubseclink" data-pltdoc="x">Predicate Annotations</a></td></tr><tr><td><span class="tocsublinknumber">2.1.10.5<tt>&nbsp;</tt></span><a href="#%28part._s~3atuple-ann%29" class="tocsubseclink" data-pltdoc="x">Tuple Annotations</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="Expressions.html" title="backward to &quot;2.1.9 Expressions&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="s_forms.html" title="up to &quot;2.1 Language Constructs&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="testing.html" title="forward to &quot;2.2 Testing&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h5>2.1.10<tt>&nbsp;</tt><a name="(part._s~3aannotations)"></a>Annotations</h5><blockquote class="SCodeFlow" style="white-space: pre;"><p><a name="(elem._(bnf-prod._(.Pyret._ann)))"></a>&#8249;ann&#8250;<span class="bnf-meta">:</span> <a href="#%28elem._%28bnf-prod._%28.Pyret._name-ann%29%29%29" data-pltdoc="x">&#8249;name-ann&#8250;</a><span class="bnf-meta"> | </span><font class="badlink">&#8249;record-ann&#8250;</font><span class="bnf-meta"> | </span><a href="#%28elem._%28bnf-prod._%28.Pyret._arrow-ann%29%29%29" data-pltdoc="x">&#8249;arrow-ann&#8250;</a><span class="bnf-meta"> | </span><a href="#%28elem._%28bnf-prod._%28.Pyret._app-ann%29%29%29" data-pltdoc="x">&#8249;app-ann&#8250;</a><span class="bnf-meta"> | </span><a href="#%28elem._%28bnf-prod._%28.Pyret._pred-ann%29%29%29" data-pltdoc="x">&#8249;pred-ann&#8250;</a><span class="bnf-meta"> | </span><a href="#%28elem._%28bnf-prod._%28.Pyret._dot-ann%29%29%29" data-pltdoc="x">&#8249;dot-ann&#8250;</a><span class="bnf-meta"> | </span><a href="#%28elem._%28bnf-prod._%28.Pyret._tuple-ann%29%29%29" data-pltdoc="x">&#8249;tuple-ann&#8250;</a></p></blockquote><p>Annotations in Pyret express intended types values will have at runtime.
They appear next to identifiers anywhere a <span class="stt">binding</span> is specified in the
grammar, and if an annotation is present adjacent to an identifier, the program
is compiled to raise an error if the value bound to that identifier would
behave in a way that violates the annotation.  The annotation provides a
<span style="font-style: italic">guarantee</span> that either the value will behave in a particular way, or the
program will raise an exception. In addition, annotations can be checked
by Pyret&rsquo;s <a href="type-check.html" data-pltdoc="x">type checker</a> to ensure that all values
have the expected types and are used correctly.</p><h5>2.1.10.1<tt>&nbsp;</tt><a name="(part._s~3aname-ann)"></a>Name Annotations</h5><p><div class="SIntrapara"><blockquote class="SCodeFlow" style="white-space: pre;"><p><a name="(elem._(bnf-prod._(.Pyret._name-ann)))"></a>&#8249;name-ann&#8250;<span class="bnf-meta">:</span> <span class="bnf-lit bnf-unknown">NAME</span>
<a name="(elem._(bnf-prod._(.Pyret._dot-ann)))"></a>&#8249;dot-ann&#8250;<span class="bnf-meta">:</span> <span class="bnf-lit bnf-unknown">NAME</span> <span class="bnf-lit">.</span> <span class="bnf-lit bnf-unknown">NAME</span></p></blockquote></div><div class="SIntrapara">Some annotations are simply names.  For example, a
<a href="Declarations.html#%28part._s~3adata-decl%29" data-pltdoc="x"><span class="stt">data declaration</span></a> binds the name of the
declaration as a value suitable for use as a name annotation.  There are
built-in name annotations, too:</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Any</span></p></td></tr><tr><td><p><span class="stt">Number</span></p></td></tr><tr><td><p><span class="stt">String</span></p></td></tr><tr><td><p><span class="stt">Boolean</span></p></td></tr></table></blockquote><p>Each of these names represents a particular type of runtime value, and using
them in annotation position will check each time the identifier is bound that
the value is of the right type.</p><pre class="pyret-block"><pre class="pyret-highlight"><p>x :: Number = "not-a-number"
# Error: expected Number and got "not-a-number"</p></pre></pre><p><span class="stt">Any</span> is an annotation that allows any value to be used.  It&rsquo;s semantically
equivalent to not putting an annotation on an identifier, but it allows a
program to clearly signal that no restrictions are intended for the identifier
it annotates.</p><p><div class="SIntrapara">Dot-annotations allow for importing types from modules:
</div><div class="SIntrapara"><pre class="pyret-block"><pre class="pyret-highlight"><p>import equality as EQ
eq-reqult :: EQ.EqualityResult = equal-always3(5, 6)</p></pre></pre></div></p><h5>2.1.10.2<tt>&nbsp;</tt><a name="(part._s~3aapp-ann)"></a>Parametric Annotations</h5><blockquote class="SCodeFlow" style="white-space: pre;"><p><a name="(elem._(bnf-prod._(.Pyret._app-ann)))"></a>&#8249;app-ann&#8250;<span class="bnf-meta">:</span> <a href="#%28elem._%28bnf-prod._%28.Pyret._name-ann%29%29%29" data-pltdoc="x">&#8249;name-ann&#8250;</a> <span class="bnf-lit">&lt;</span> <a href="#%28elem._%28bnf-prod._%28.Pyret._comma-anns%29%29%29" data-pltdoc="x">&#8249;comma-anns&#8250;</a> <span class="bnf-lit">&gt;</span>
              <span class="bnf-meta"> | </span><a href="#%28elem._%28bnf-prod._%28.Pyret._dot-ann%29%29%29" data-pltdoc="x">&#8249;dot-ann&#8250;</a> <span class="bnf-lit">&lt;</span> <a href="#%28elem._%28bnf-prod._%28.Pyret._comma-anns%29%29%29" data-pltdoc="x">&#8249;comma-anns&#8250;</a> <span class="bnf-lit">&gt;</span>
<a name="(elem._(bnf-prod._(.Pyret._comma-anns)))"></a>&#8249;comma-anns&#8250;<span class="bnf-meta">:</span> <a href="#%28elem._%28bnf-prod._%28.Pyret._ann%29%29%29" data-pltdoc="x">&#8249;ann&#8250;</a> <span class="bnf-meta">(</span><span class="bnf-lit">,</span> <a href="#%28elem._%28bnf-prod._%28.Pyret._ann%29%29%29" data-pltdoc="x">&#8249;ann&#8250;</a><span class="bnf-meta">)</span><span class="bnf-meta">*</span></p></blockquote><p><div class="SIntrapara">Many data definitions are parametric, meaning they can contain any
uniform type of data, such as lists of numbers.  Accordingly, while
the following annotation isn&rsquo;t quite wrong, it is incomplete:
</div><div class="SIntrapara"><pre class="pyret-block"><pre class="pyret-highlight ok-ex"><p>list-of-nums :: List = [list: 1, 2, 3]</p></pre></pre></div></p><p><div class="SIntrapara">To properly express the constraint on the contents, we need to
specialize the list annotation:
</div><div class="SIntrapara"><pre class="pyret-block"><pre class="pyret-highlight good-ex"><p>list-of-nums :: List&lt;Number&gt; = [list: 1, 2, 3]</p></pre></pre></div></p><p>Note that this annotation will <span style="font-style: italic">not dynamically check</span> that every
item in the list is in fact a <span class="stt">Number</span> &#8212;<wbr></wbr> that would be infeasibly
expensive.  However, the <font class="badlink">static type checker</font>
will make use of this information more fully.</p><h5>2.1.10.3<tt>&nbsp;</tt><a name="(part._s~3aarrow-ann)"></a>Arrow Annotations</h5><p>An arrow annotation is used to describe the behavior of functions.  It consists
of a list of comma-separated argument types followed by an ASCII arrow and
return type:</p><blockquote class="SCodeFlow" style="white-space: pre;"><p><a name="(elem._(bnf-prod._(.Pyret._arrow-ann)))"></a>&#8249;arrow-ann&#8250;<span class="bnf-meta">:</span> <span class="bnf-lit">(</span> <span class="bnf-meta">(</span><a href="#%28elem._%28bnf-prod._%28.Pyret._arrow-ann-elt%29%29%29" data-pltdoc="x">&#8249;arrow-ann-elt&#8250;</a><span class="bnf-meta">)</span><span class="bnf-meta">*</span> <a href="#%28elem._%28bnf-prod._%28.Pyret._ann%29%29%29" data-pltdoc="x">&#8249;ann&#8250;</a> <span class="bnf-lit">-&gt;</span> <a href="#%28elem._%28bnf-prod._%28.Pyret._ann%29%29%29" data-pltdoc="x">&#8249;ann&#8250;</a> <span class="bnf-lit">)</span>
<a name="(elem._(bnf-prod._(.Pyret._arrow-ann-elt)))"></a>&#8249;arrow-ann-elt&#8250;<span class="bnf-meta">:</span> <a href="#%28elem._%28bnf-prod._%28.Pyret._ann%29%29%29" data-pltdoc="x">&#8249;ann&#8250;</a> <span class="bnf-lit">,</span></p></blockquote><p>When an arrow annotation appears in a binding, that binding position simply
checks that the value is a function.</p><h5>2.1.10.4<tt>&nbsp;</tt><a name="(part._s~3apred-ann)"></a>Predicate Annotations</h5><p>A predicate annotation is used to <span style="font-style: italic">refine</span> the annotations
describing the a value.</p><blockquote class="SCodeFlow" style="white-space: pre;"><p><a name="(elem._(bnf-prod._(.Pyret._pred-ann)))"></a>&#8249;pred-ann&#8250;<span class="bnf-meta">:</span> <a href="#%28elem._%28bnf-prod._%28.Pyret._ann%29%29%29" data-pltdoc="x">&#8249;ann&#8250;</a> <span class="bnf-lit">%</span> <span class="bnf-lit">(</span> <span class="bnf-lit bnf-unknown">NAME</span> <span class="bnf-lit">)</span></p></blockquote><p>For example, a function might only work on non-empty lists.  We might
write this as</p><pre class="pyret-block"><pre class="pyret-highlight good-ex"><p>fun do-something-with&lt;a&gt;(non-empty-list :: List&lt;a&gt;%(is-link)) -&gt; a: ... end</p></pre></pre><p>If we want to write customized predicates, we can easily do so.  Those
predicates must be defined <span style="font-style: italic">before</span> being used in an annotation
position, and must be refered to by name</p><h5>2.1.10.5<tt>&nbsp;</tt><a name="(part._s~3atuple-ann)"></a>Tuple Annotations</h5><p>Annotating a tuple is syntactically very similar to writing a tuple value:</p><blockquote class="SCodeFlow" style="white-space: pre;"><p><a name="(elem._(bnf-prod._(.Pyret._tuple-ann)))"></a>&#8249;tuple-ann&#8250;<span class="bnf-meta">:</span> <span class="bnf-lit">{</span> <a href="#%28elem._%28bnf-prod._%28.Pyret._ann%29%29%29" data-pltdoc="x">&#8249;ann&#8250;</a> <span class="bnf-meta">(</span><span class="bnf-lit">;</span> <a href="#%28elem._%28bnf-prod._%28.Pyret._ann%29%29%29" data-pltdoc="x">&#8249;ann&#8250;</a><span class="bnf-meta">)</span><span class="bnf-meta">*</span> <span class="bnf-meta">[</span><span class="bnf-lit">;</span><span class="bnf-meta">]</span> <span class="bnf-lit">}</span></p></blockquote><p>Each component is itself an annotation.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="Expressions.html" title="backward to &quot;2.1.9 Expressions&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="s_forms.html" title="up to &quot;2.1 Language Constructs&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="testing.html" title="forward to &quot;2.2 Testing&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>